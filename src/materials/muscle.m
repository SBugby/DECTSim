function mu = muscle(energy)
  if energy <= 1.07210E-03
    mu = interp_mu([1.00000E-03; 1.03542E-03; 1.07210E-03], [3.719E+03; 3.393E+03; 3.094E+03], energy);
  elseif energy <= 2.14550E-03
    mu = interp_mu([1.07210E-03; 1.50000E-03; 2.00000E-03; 2.14550E-03], [3.100E+03; 1.251E+03; 5.594E+02; 4.581E+02], energy);    
  elseif energy <= 2.47200E-03
    mu = interp_mu([2.14550E-03; 2.30297E-03; 2.47200E-03], [4.626E+02; 3.776E+02; 3.085E+02], energy);
  elseif energy <= 2.82240E-03
    mu = interp_mu([2.47200E-03; 2.64140E-03; 2.82240E-03], [3.140E+02; 2.597E+02; 2.145E+02], energy);
  elseif energy <= 3.60740E-03
    mu = interp_mu([2.82240E-03; 3.00000E-03; 3.60740E-03], [2.160E+02; 1.812E+02; 1.057E+02], energy);
  else
    mu = interp_mu([
      3.60740E-03; 4.00000E-03; 5.00000E-03;
      6.00000E-03; 8.00000E-03; 1.00000E-02;
      1.50000E-02; 2.00000E-02; 3.00000E-02;
      4.00000E-02; 5.00000E-02; 6.00000E-02;
      8.00000E-02; 1.00000E-01; 1.50000E-01;
      2.00000E-01; 3.00000E-01; 4.00000E-01;
      5.00000E-01; 6.00000E-01; 8.00000E-01;
      1.00000E+00; 1.25000E+00; 1.50000E+00;
      2.00000E+00; 3.00000E+00; 4.00000E+00;
      5.00000E+00; 6.00000E+00; 8.00000E+00;
      1.00000E+01; 1.50000E+01; 2.00000E+01;
    ], [
      1.100E+02; 8.127E+01; 4.206E+01;
      2.446E+01; 1.037E+01; 5.356E+00;
      1.693E+00; 8.205E-01; 3.783E-01;
      2.685E-01; 2.262E-01; 2.048E-01;
      1.823E-01; 1.693E-01; 1.492E-01;
      1.358E-01; 1.176E-01; 1.052E-01;
      9.598E-02; 8.874E-02; 7.793E-02;
      7.007E-02; 6.265E-02; 5.701E-02;
      4.896E-02; 3.931E-02; 3.369E-02;
      3.000E-02; 2.741E-02; 2.401E-02;
      2.192E-02; 1.915E-02; 1.786E-02;
    ], energy);
  end
  mu = mu * 1.050; % correction for muscle density https://physics.nist.gov/PhysRefData/XrayMassCoef/tab2.html
end